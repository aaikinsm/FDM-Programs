package com.fdmgroup.model;

import java.util.ArrayList;

import com.fdmgroup.dao.ExamCollectionDao;

public class Exam {

	private int id, currentIndex=-1;
	private User creator;
	private boolean isDeleted, isRandomized;
	private ArrayList<Question> questions;
	private long timer;
	private ExamCollectionDao examDao;
	
	public Exam(int id, User creator, boolean isRandomized, long timer) {
		super();
		this.id = id;
		this.creator = creator;
		this.isRandomized = isRandomized;
		this.timer = timer;
		examDao = ExamCollectionDao.getInstance();
	}
	
	public void addQuestion(Question q){
		questions.add(q);
	}

	public void removeQuestion(Question q){
		questions.remove(q);
	}
	
	public void start(){
		if(isRandomized){
			ArrayList<Question> randQuestions = new ArrayList<>();
			for (int i = 0; i < questions.size(); i++) {
				int num = (int) (Math.random()*questions.size());
				randQuestions.add(questions.get(num));
				questions.remove(num);
			}
			questions = randQuestions;
		}
	}
	
	public Question getNextQuestion(){
		currentIndex++;
		return(questions.get(currentIndex));
	}
	
	public void setDeleted(boolean yes){
		if (yes && !isDeleted){
			examDao.deleteExam(this);
			isDeleted = true;
		}
		if (!yes && isDeleted){
			examDao.recoverExam(this);
			isDeleted = false;
		}
	}
	
}
