package com.fdmgroup.model;

import javax.persistence.EntityManager;

import com.fdmgroup.dao.DbConnection;
import com.fdmgroup.dao.ExamCollectionDao;
import com.fdmgroup.dao.UserCollectionDao;

public class DaoTest {
	private static ExamCollectionDao examCollectionDao = ExamCollectionDao.getInstance();
	private static UserCollectionDao userCollectionDao = UserCollectionDao.getInstance();
	private static DbConnection connection = DbConnection.getInstance();;
	public static EntityManager em;
	

	public static void main(String[] args) {
		
		em = connection.getEntityManager();
		em.getTransaction().begin();
		
		User u = new User(1,"aam","password123","Albert", "Mensah");
		User createdUser = create(u);
		User u2 = new User(1,"jd","123","John", "Doe");
		User createdUser2 = create(u2);
		//em.persist(u);
		
		System.out.println("User Created");
		
		Question q1 = new Question("What is red?");
		q1.addPossibleAnswer("a) A shape");
		q1.addPossibleAnswer("b) A color");
		q1.setCorrectAnswer("b");
		Question q2 = new Question("What is 5+2?");
		q2.addPossibleAnswer("a) 7");
		q2.addPossibleAnswer("b) 8");
		q2.setCorrectAnswer("a");
		Exam myExam = new Exam(30, "My Almighty Exam", true, createdUser);
		myExam.addQuestion(q1);
		myExam.addQuestion(q2);
		create(myExam);
		//em.persist(myExam);

		System.out.println("Exam Created");
		

		em.close();
	}
	
	public static Exam create(Exam exam) {
		//EntityManager em = connection.getEntityManager();
		//em.getTransaction().begin();
		em.persist(exam);
		em.getTransaction().commit();
		//em.close();
		return exam;
	}
	
	public static User create (User user){
		//EntityManager em = connection.getEntityManager();
		if(!em.getTransaction().isActive())
			em.getTransaction().begin();
		em.persist(user);
		em.getTransaction().commit();
		//em.close();
		return user;
	}
}
