package com.fdmgroup;

import java.io.Closeable;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class JdbcApp {

	private static final String DATABASE_PASSWORD = "!QAZSE4";
	private static final String DATABASE_USERNAME = "trainee1";
	private static final String DATABASE_URL = "jdbc:oracle:thin:@localhost:1521:xe";

	public static void main(String[] args) {
		//testStatement();
		testResultSet();
	}

	private static void testResultSet() {
		
		Connection connection = null;
		Statement statement = null;
		ResultSet resultSet = null;
		
		try {
			connection = DriverManager.getConnection(DATABASE_URL, DATABASE_USERNAME, DATABASE_PASSWORD);
			statement = connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);	
			statement.executeQuery("SELECT user_id, username, pw, firstname, lastname FROM TBL_USER");
			resultSet = statement.getResultSet();
			
			while (resultSet.next()){
				int id = resultSet.getInt("user_id"); //resultSet.getInt(1);
				String username = resultSet.getString(2);
				String password = resultSet.getString(3);
				String firstname = resultSet.getString("firstname");
				String lastname = resultSet.getString(5);
				
				resultSet.updateString("pw", "123456");
				resultSet.updateRow();
				
				System.out.println(id + ") "+firstname+" "+lastname+" -->  "+username+", "+password );
			}
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			close(statement);
			close(connection);
		}
	}

	private static void testStatement() {
		Connection connection = null;
		Statement statement = null;
		try {
			connection = DriverManager.getConnection(DATABASE_URL, DATABASE_USERNAME, DATABASE_PASSWORD);
			statement = connection.createStatement();
			/*statement.execute(
					"CREATE TABLE TBL_USER(user_id NUMBER(6) PRIMARY KEY, username VARCHAR2(50), pw VARCHAR2(50), firstname VARCHAR2(50), lastname VARCHAR2(50))");
			statement.executeUpdate("INSERT INTO TBL_USER(user_id, username, pw, firstname, lastname) VALUES(1, 'jDoe', 1233, 'John', 'Doe')");
			statement.executeUpdate("INSERT INTO TBL_USER(user_id, username, pw, firstname, lastname) VALUES(2, 'seth', 4357, 'Sethelina', 'Adusei')");
			statement.executeUpdate("INSERT INTO TBL_USER(user_id, username, pw, firstname, lastname) VALUES(3, 'aam', 1643, 'Albert', 'Aikins')");
			statement.executeUpdate("INSERT INTO TBL_USER(user_id, username, pw, firstname, lastname) VALUES(4, 'erict', 1276, 'Erick', 'Thomas')");
			statement.executeUpdate("INSERT INTO TBL_USER(user_id, username, pw, firstname, lastname) VALUES(5, 'menLuc', 2474, 'Lucas', 'Men')");
*/			
			statement.executeUpdate("UPDATE TBL_USER SET pw = '6393' WHERE user_id = 3");
			System.out.println("update complete");
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			close(statement);
			close(connection);
		}

	}

	private static void close(AutoCloseable closeable) {
		try {
			if (closeable != null) {
				closeable.close();
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}
